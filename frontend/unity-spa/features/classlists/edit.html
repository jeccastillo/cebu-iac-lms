<div class="space-y-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-semibold text-gray-800">
      {{ vm.id ? 'Edit Classlist #' + vm.id : 'Add Classlist' }}
    </h1>
    <div class="flex items-center space-x-2">
      <button class="inline-flex items-center px-3 py-2 rounded bg-gray-100 text-gray-800 hover:bg-gray-200"
              ng-click="vm.cancel()">
        <span class="fas fa-arrow-left mr-2"></span> Back
      </button>
    </div>
  </div>

  <!-- Alerts -->
  <div ng-if="vm.error" class="rounded border border-red-200 bg-red-50 text-red-800 px-4 py-3">
    <span class="fas fa-exclamation-triangle mr-2"></span> {{ vm.error }}
  </div>
  <div ng-if="vm.success" class="rounded border border-green-200 bg-green-50 text-green-800 px-4 py-3">
    <span class="fas fa-check mr-2"></span> {{ vm.success }}
  </div>

  <!-- Form -->
  <form class="bg-white p-6 rounded shadow border border-gray-200" ng-submit="vm.save()" novalidate>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Subject -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Subject</label>
        <select class="w-full border rounded px-3 py-2" ng-model="vm.model.intSubjectID"
                ng-options="s.subject_id as (s.strCode + ' - ' + s.strDescription) for s in vm.subjects" required>
          <option value="">-- Select Subject --</option>
        </select>
        <p class="text-xs text-gray-500 mt-1">Subjects are scoped by the selected academic term.</p>
      </div>

      <!-- Faculty -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Faculty</label>
        <select class="w-full border rounded px-3 py-2" ng-model="vm.model.intFacultyID"
                ng-options="f.intID as (f.strLastname + ', ' + f.strFirstname) for f in vm.faculty">
          <option value="">-- Select Faculty --</option>
        </select>
      </div>

      <!-- Academic Year (Term) -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Academic Year (Term)</label>
        <div class="w-full border rounded px-3 py-2 bg-gray-50 text-gray-700">
          {{ vm.termLabel || '-' }}
        </div>
        <input type="hidden" ng-model="vm.model.strAcademicYear">
        <p class="text-xs text-gray-500 mt-1">
          Display only. Format: "enumSem term_label strYearStart-strYearEnd".
        </p>
      </div>

      <!-- Units -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Units</label>
        <input type="text" class="w-full border rounded px-3 py-2" ng-model="vm.model.strUnits" maxlength="20" placeholder="e.g. 3">
      </div>

      <!-- Section Code -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Section Code</label>
        <input type="text" class="w-full border rounded px-3 py-2" ng-model="vm.model.sectionCode" maxlength="50" placeholder="e.g. MMA11">
        <p class="text-xs text-gray-500 mt-1">Note: This will be used for block sectioning</p>
      </div>

      <!-- Finalized -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Finalized</label>
        <select class="w-full border rounded px-3 py-2" ng-model="vm.model.intFinalized"
                ng-options="o.value as o.label for o in vm.finalizedOptions" required>
        </select>
      </div>

      <!-- Campus -->
      <div ng-if="!vm.id">
        <label class="block text-sm font-medium text-gray-700 mb-1">Campus</label>
        <div class="w-full border rounded px-3 py-2 bg-gray-50 text-gray-700">
          {{ vm.campusName || 'No campus selected' }}
        </div>
        <input type="hidden" ng-model="vm.model.campus_id">
        <p class="text-xs text-gray-500 mt-1">Derived from the global campus selection. Read-only on Add.</p>
      </div>
      <div ng-if="vm.id">
        <label class="block text-sm font-medium text-gray-700 mb-1">Campus</label>
        <select class="w-full border rounded px-3 py-2"
                ng-model="vm.model.campus_id">
                <option value="">-- Select Campus --</option>
                <option ng-repeat="c in vm.campuses" ng-value="c.id">{{ c.campus_name }}</option>          
        </select>
      </div>
      <!-- Special Class -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Special Class</label>
        <div class="flex items-center space-x-3">
          <input type="checkbox"
                 class="h-4 w-4 text-blue-600 border-gray-300 rounded"
                 ng-model="vm.model.special_class"
                 ng-true-value="1"
                 ng-false-value="0">
          <span class="text-sm text-gray-700">Apply multiplier to tuition for this class (NSTP excluded).</span>
        </div>
      </div>

      <!-- Multiplier -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Multiplier</label>
        <input type="number"
               step="0.0001"
               min="0.0001"
               class="w-full border rounded px-3 py-2"
               ng-model="vm.model.special_multiplier"
               ng-disabled="!vm.model.special_class"
               placeholder="e.g. 1.2500">
        <p class="text-xs text-gray-500 mt-1">Default 1.0000 (no change). Only applied when Special Class is enabled.</p>
      </div>
    </div>

    <div class="mt-6 flex items-center space-x-2">
      <button type="submit" class="inline-flex items-center px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700" ng-disabled="vm.loading">
        <span class="fas fa-save mr-2"></span> Save
      </button>
      <button type="button" class="inline-flex items-center px-4 py-2 rounded bg-gray-100 text-gray-800 hover:bg-gray-200" ng-click="vm.cancel()" ng-disabled="vm.loading">
        Cancel
      </button>
    </div>
  </form>
</div>
